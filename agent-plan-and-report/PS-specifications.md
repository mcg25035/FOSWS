# FOMO線上購物網站系統 (FOMO Online Shopping Website System) [FOSWS]
## 需求文件(V. 1.0)

---

## 第五章 金流子系統 (PS 1.4.n)

### 5.1 子系統描述
本模組負責線上支付流程管理與第三方金流整合,包含:
* 信用卡授權與驗證。
* 第三方支付串接(LINE Pay、街口、Apple Pay)。
* 退款、對帳與異常處理。
* 金流安全性監控與稽核記錄。

### 5.2 功能需求

#### 5.2.1 交易處理與支付管理

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PS001 | 1 | 支援信用卡與第三方支付功能 |
| PS002 | 1 | 每筆交易須具唯一交易編號並完整紀錄狀態。 |
| PS003 | 1 | 系統支援退款流程並保留審核紀錄。 |
| PS004 | 1 | 異常交易觸發通知並自動回滾。 |
| PS005 | 1 | 系統每日自動對帳並產生報告 |

#### 5.2.2 使用者交易紀錄查詢

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| TR001 | 1 | 使用者可查詢歷史支付記錄,包括金額、時間、支付方式等。 |
| TR002 | 1 | 系統提供交易狀態篩選功能(成功、失敗、退款中)。 |
| TR003 | 2 | 支援匯出個人交易紀錄為PDF 或Excel檔。 |
| TR004 | 2 | 查詢結果應顯示訂單明細與對應服務項目名稱。 |

#### 5.2.3 金流通知與訊息中心

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| NT001 | 1 | 系統發送付款成功、失敗、退款等通知至使用者信箱。 |
| NT002 | 2 | 通知類型支援 Email 與系統內訊息中心雙渠道 |

#### 5.2.4 金流客服與即時協助模組

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| CS001 | 1 | 使用者可於系統內提交金流相關問題單(客服單) |
| CS002 | 2 | 支援留言討論、回覆與附件上傳功能 |

#### 5.2.5 付款人基本資料與帳號維護

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| AC001 | 1 | 使用者可編輯付款資料,包括姓名、地址、聯絡方式。 |
| AC002 | 1 | 系統應驗證電子郵件與手機號碼之正確性。 |

### 5.3 介面需求

#### 5.3.1 內部介面

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSIF001 | 1 | 金流模組應與訂單模組同步更新交易狀態。 |
| PSIF002 | 2 | 金流與DB 模組間須具事務控制機制確保一致性。 |

#### 5.3.2 外部介面

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSIF003 | 1 | 系統應整合第三方金流API並通過簽章驗證 |
| PSIF004 | 2 | 系統應提供對外回調介面供金流平台回傳狀態。 |

### 5.4 效能需求

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSPF001 | 1 | 每筆金流交易應於2秒內完成。 |
| PSPF002 | 2 | 系統同時可處理至少200筆交易 |

### 5.5 操作概念
* 顧客提交訂單後系統送出交易請求。
* 第三方金流回傳授權結果。
* 系統依結果更新訂單狀態並記錄日誌。
* 若交易失敗,系統回滾並通知顧客。

### 5.6 安全、可信度、維護需求

#### 5.6.1 安全需求

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSS001 | 1 | 只有顧客帳號可以登入訂單查詢系統 |
| PSS002 | 1 | 系統不得儲存完整信用卡資料。 |
| PSS003 | 2 | API 金鑰須以環境變數安全儲存 |

#### 5.6.2 可信度需求

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSR001 | 1 | 系統具重送機制以確保交易成功率。 |
| PSR002 | 2 | 若交易中斷應自動恢復並通知使用者。 |

#### 5.6.3 維護需求

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSM001 | 1 | 提供交易日誌查詢介面 |
| PSM002 | 2 | 金流模組 API可獨立部署維護 |

### 5.7 交付、安裝、環境需求

#### 5.7.1 交付需求

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSD001 | 1 | 模組交付前須通過安全稽核與測試。 |

#### 5.7.2 安裝需求

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSD002 | 2 | 模組應支援 Docker 容器化部署 |

#### 5.7.3 環境需求

| 需求編號 | 優先順序 | 需求描述 |
| :--- | :--- | :--- |
| PSD003 | 2 | 系統應可於AWS/Azure/GCP等雲環境運行。 |
